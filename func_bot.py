import random

import requests


def get_apod_photo_info(api_key):
    url = f'https://api.nasa.gov/planetary/apod?api_key={api_key}'
    response = requests.get(url)
    data = response.json()
    return data


def get_random_space_fact(api_key):
    local_facts = [
        "1. Космос — это почти полная пустота. Между звездами и планетами находятся огромные пустые пространства, в которых почти нет частиц материи. Это объясняет, почему космос часто называют 'вакуумом'.",
        "2. Свет от Солнца достигает Земли за 8 минут. Несмотря на огромное расстояние в 150 миллионов километров, свет от Солнца достигает Земли всего за 8 минут и 20 секунд.",
        "3. Гравитация на Луне в 6 раз слабее, чем на Земле. Из-за этого астронавты могут легко прыгать на высоту в несколько раз больше, чем на Земле.",
        "4. Венера — самая горячая планета в Солнечной системе. Температура на поверхности Венеры достигает 465°C, что горячее, чем на Меркурии, хотя Венера дальше от Солнца.",
        "5. В космосе нет звука. Звук не может распространяться в вакууме, так как ему нужны молекулы воздуха или другого вещества для передачи волн.",
        "6. В космосе нельзя заплакать. В условиях микрогравитации слезы не падают вниз, как на Земле, а остаются на глазах в виде маленьких капель.",
        "7. Солнце составляет 99,86% массы всей Солнечной системы. Огромная звезда занимает почти весь вес нашей системы, при этом планеты, спутники и астероиды составляют лишь малую часть.",
        "8. Марс имеет самые высокие горы в Солнечной системе. Гора Олимп, находящаяся на Марсе, является самой высокой в Солнечной системе. Ее высота достигает 21 километра.",
        "9. Юпитер — самая быстрая планета. Юпитер делает один оборот вокруг своей оси всего за 10 часов. Из-за этого он слегка сплющен на полюсах.",
        "10. Сатурн может плавать в воде. Если бы существовал бассейн с водой достаточного размера, Сатурн, из-за своей низкой плотности, плавал бы на поверхности.",
        "11. Один день на Венере дольше её года. Венера вращается так медленно, что один полный оборот вокруг своей оси занимает больше времени, чем её оборот вокруг Солнца.",
        "12. Вода есть не только на Земле. Ученые обнаружили водяной лед на многих других телах Солнечной системы, таких как Луна, Марс и спутники Юпитера и Сатурна.",
        "13. В космосе можно встретить 'алмазные планеты'. Некоторые планеты, например 55 Cancri e, по предположениям ученых, состоят в значительной части из углерода, который под высоким давлением превращается в алмаз.",
        "14. Большая часть Вселенной состоит из тёмной материи и энергии. Тёмная материя и энергия составляют около 95% всей массы и энергии Вселенной, но они остаются практически не изученными.",
        "15. Кометы — это ледяные глыбы. Кометы состоят из пыли, льда и газа. Когда они приближаются к Солнцу, лёд испаряется, создавая яркие хвосты.",
        "16. На Меркурии нет атмосферы. Из-за этого перепады температуры на планете невероятны: днем может быть до 430°C, а ночью — до -180°C.",
        "17. Вокруг Юпитера вращается больше 70 спутников. Самые крупные спутники Юпитера, известные как Галилеевы спутники, были открыты еще в 1610 году Галилео Галилеем.",
        "18. Плутон имеет пять спутников. Самый большой из них — Харон, и его диаметр составляет половину диаметра Плутона.",
        "19. Черные дыры настолько плотны, что даже свет не может из них выбраться. Черные дыры образуются, когда звезды умирают и их гравитация становится настолько сильной, что свет не может покинуть их пределы.",
        "20. Астронавты становятся выше в космосе. Из-за отсутствия гравитации позвоночник астронавтов расправляется, и они могут 'вырасти' на 5 см.",
        "21. Млечный Путь движется с огромной скоростью. Наша галактика движется через космос со скоростью 600 километров в секунду.",
        "22. Галактики могут сталкиваться. Хотя в космосе огромное количество свободного пространства, галактики могут сталкиваться друг с другом. Пример — предстоящее столкновение Млечного Пути и Андромеды.",
        "23. Вселенная может быть бесконечной. Несмотря на расширение Вселенной, она может не иметь границ, и этот вопрос остается одним из величайших научных загадок.",
        "24. Луна постепенно удаляется от Земли. Каждый год Луна отдаляется от Земли примерно на 3,8 сантиметра.",
        "25. Существуют 'звезды-зомби'. Когда звезда превращается в сверхновую, её остатки могут продолжать 'жить' в виде пульсара или черной дыры.",
        "26. В космосе есть 'глаз'. Туманность Гелика — это газообразное облако, образованное умирающей звездой, которое напоминает огромный глаз.",
        "27. Космический мусор — растущая проблема. Тысячи спутников и обломков вращаются вокруг Земли, представляя опасность для будущих космических полетов.",
        "28. В космосе можно весить меньше. Из-за низкой силы тяжести в космосе вес человека резко уменьшается, хотя масса остаётся прежней.",
        "29. Звезды рождаются в облаках газа. Звезды формируются в гигантских газовых облаках, когда они начинают сжиматься под воздействием гравитации.",
        "30. Некоторые планеты вращаются 'на боку'. Уран вращается почти перпендикулярно своей орбите, что делает его уникальной планетой в Солнечной системе.",
        "31. Туманность Ориона — 'звездная фабрика'. Это одно из самых ярких мест на ночном небе, где образуются новые звезды.",
        "32. У Земли есть 'второй Лунный спутник'. Некоторые астероиды временно захватываются гравитацией Земли и вращаются вокруг неё несколько лет, прежде чем покинуть орбиту.",
        "33. Планета HD 189733b — одна из самых странных. На этой планете, находящейся за пределами Солнечной системы, идут дожди из стекла, дующим боковым ветром.",
        "34. Время на краю черной дыры замедляется. Из-за огромной гравитации черных дыр время рядом с ними замедляется относительно времени на Земле.",
        "35. Космос бесконечно расширяется. Учёные доказали, что Вселенная не только расширяется, но и делает это с ускорением, благодаря тёмной энергии, которая остается загадкой для науки.",
        "36.У Сатурна есть более 140 известных колец!",
        "37.Скорость света — почти 300,000 км/с.",
        "38.Международная космическая станция летает со скоростью 28,000 км/ч!",
        "39.На Марсе закаты синие, а не красные.",
        "40.Чёрные дыры искривляют пространство и время."
    ]


    try:
        url = f'https://api.nasa.gov/planetary/apod?api_key={api_key}'
        response = requests.get(url)
        data = response.json()
        nasa_fact = data.get('explanation')
        title = data.get('title')
        full_nasa_fact = f"📌 *{title}*\n\n{nasa_fact}"
        sources = [full_nasa_fact, *local_facts]
    except Exception as e:
        print(f"[NASA API ERROR]: {e}")
        sources = local_facts  

    return random.choice(sources)


def get_iss_location():
    try:
        url = f'http://api.open-notify.org/iss-now.json'
        response = requests.get(url)
        data = response.json()
        latitude = data['iss_position']['latitude']
        longitude = data['iss_position']['longitude']
        return f"""Широта {data['iss_position']['latitude']}
Долгота {data['iss_position']['longitude']}""", latitude, longitude
    except:
        return 'Sorry bro'


def get_asteroid():
    try:
        url = f'https://ssd-api.jpl.nasa.gov/sbdb.api?sstr=APOPHIS'
        response = requests.get(url)
        data = response.json()
        name = data['object']['fullname']
        moid = data['orbit']['moid']
        orbit_class_code = data['object']['orbit_class']['code']
        last_obs = data['orbit']['last_obs']
        return f'''
☄️ *Астероид обнаружен!*\n
📛 Имя {name},\n
📏 Ближайшее Расстояние {moid},\n
🛰 Класс орбиты  {orbit_class_code} ,\n
📅    Последняя дата наблюдения {last_obs}
'''

    except:
        return 'sorry'

